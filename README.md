# README

# SHOGI DIARYアプリ

## 概要
ユーザが画像と一緒に日記を投稿することができるアプリ。
タグ付けや他のユーザの日記にコメントをつけることで交流を行える。

## URL

https://shogi-diary-36755.herokuapp.com/

## テスト用アカウント

ユーザー1  
Mail: sample1@mail.com  
Pass: test00  

ユーザー2  
Mail: sample2@mail.com  
Pass: test00  

## 利用方法

・メールアドレスとパスワードを使ってユーザ登録を行う。  
・ログインしているユーザはヘッダーの「新規投稿」ボタンから日記の新規投稿が行える。  
・手持ちの画像か局面図を作成し、本文を入力して投稿する。  
・トップページでは投稿された記事がすべて表示される。  
・各記事のタイトルをクリックすると記事の詳細を確認できる。  
・記事の詳細ページではコメントを残すことができる。  
・記事にタグをつけることでタグを使った検索機能が利用できる。


## 目指した課題解決

将棋に関する日常的な日記や、棋譜ファイルとして残っていない局面などの画像を投稿して記録することができる。また、投稿した記事にコメントすることで他のユーザと感想や検討を共有することができるようになる。

## 洗い出した要件

| 機能 | 目的    | 詳細           | ストーリー           |
| --- | --- | ------------- | ----------------- |
| トップページ	| 記事一覧を見ることができる。<br>  各ページへリンクするボタンが表示されている。 |	・新規登録ページのボタンがある<br> ・サインインページのボタンがある<br>  ・ユーザーの詳細ページのボタンがある<br>  ・記事が一覧で表示されている<br>  ・各記事の詳細ページのボタンがある<br>  ・検索ボタンがある |  ・ログインしていないときだけ新規登録ボタンが表示される<br>  ・ログインしていないときだけサインインボタンが表示される<br>  ・記事がページに収まらないときは次ページへ移動するボタンが表示される<br>  ・記事の詳細ページ、検索のボタンはログアウトしていても表示される<br>  |
| サインアップ機能 | ユーザーネーム、メールアドレス、パスワードを使ってサインアップできる。 | 	・ユーザーネームの入力が必須<br>  ・メールアドレスの入力が必須<br>  ・パスワードの入力が必須<br>  ・自己紹介の入力欄がある<br>  | ・ユーザーネームはかな、カタカナ、英文字、数字で字数制限なし<br>  ・ユーザーネームは一意でなければいけない<br>  ・メールアドレスは一意でなければいけない<br>  ・パスワードは英文字と数字でのみ入力可能<br>  ・パスワードは6文字以上<br> ・自己紹介文の入力は任意"<br>  |
| サインイン機能	| メールアドレスとパスワードを使ってサインインできる。 |・メールアドレスの入力が必須<br>  ・パスワードの入力が必須<br>  | ・登録したメールアドレスの入力が必須<br>  ・登録したパスワードの入力が必須<br> |
| ユーザページ |ユーザの投稿記事の閲覧、編集、削除ができる。|・ユーザの自己紹介文が表示される<br>  ・投稿した記事の一覧が表示される| ＜常に表示される項目＞<br>  ・投稿記事の一覧が表示されている<br>  ・記事の詳細ページのボタンがある<br>  ・ユーザーの自己紹介文が表示される<br><br>  ＜自分のユーザーページでのみ表示される項目＞<br>  ・ユーザー情報の更新ページのリンクがある<br>  ・投稿記事の詳細ページ、編集ページのボタンがある<br> |
| 日記投稿機能 |	画像、タイトル、タグ、などの情報を登録して投稿できる。|・画像のアップロードボタンがある<br> ・タイトルの入力が必須<br> ・日記の内容の入力欄がある<br> ・タグを登録、選択できる<br> | ・画像は任意でアップロード可能<br> ・タイトルが空白では登録できない<br> ・内容は任意<br> ・タグの登録、選択も任意<br> |
| 日記詳細ページ |日記の画像、タイトル、内容を閲覧し、コメントできる	|・投稿したタイトルが表示される<br>・投稿した画像が表示される<br>・投稿した内容が表示される<br>・登録したタグが表示される<br>・コメントの投稿ボタンがある<br>・投稿されたコメントが表示される |・記事のタイトル、画像、内容、タグが表示されている<br>・ログアウトしている場合コメントの投稿欄が表示されない<br> |
| コメント投稿機能 |	記事に対してコメントできる。|・内容を入力してコメントが投稿できる	|・空欄では登録できない<br>・ログインしていないと投稿できない |
| 記事検索機能 | タイトル、タグなどで記事を検索できる。|・検索キーワードを入力して記事を検索できる | ・検索キーワードを自由に入力できる<br>・検索した後はトップページに検索結果に該当する記事が表示される |
| ユーザ情報更新 |登録ユーザーの情報を編集、更新できる |・メールアドレスの更新ができる<br>・自己紹介文の更新ができる |・更新が失敗した時はページに留まる<br>・他のユーザーがアクセスしようとするとトップページへ遷移する |
| タグ追加機能 | 投稿した記事にタグを追加で登録できる |・日記詳細ページでタグを追加できる | ・日記には複数のタグを追加できる<br>・タグは他のユーザーも追加できる |
| サイドバー | 他のユーザーの一覧やタグが表示される |・ユーザーの一覧が表示される<br>・タグの一覧が表示される<br>・検索フォームがある | ・トップページ、ユーザー詳細ページ、日記詳細ページに表示される<br>・ユーザーの一覧が表示される<br>・タグの一覧ではタグ名の横に記事の数が表示される|
| 局面図作成機能 | 局面図を作成し画像としてダウンロードすることができる。|・局面を編集できる盤面図がある<br>・画像としてダウンロードできるボタンがある |・新規投稿ページへ戻るボタンがある<br>・盤上の駒は自由に動かすことができる<br>・盤外（駒箱）に駒を外すこともできる |
| 記事削除機能 | 自分の投稿した記事の削除ができる | ・記事の詳細ページから削除することができる<br>・記事に紐づいているコメントも削除される<br>・記事に登録しているタグも削除される<br>・削除する際にダイアログを表示する | ・他のユーザーの記事は削除できない<br>・削除する前に確認のメッセージで「はい」と押さなければ削除できない |
| お気に入り登録機能| 投稿された記事をお気に入りの記事として登録できる | ・記事の詳細ページでボタンを押すとお気に入り登録できる<br>・お気に入りの登録を解除できる<br>・ユーザは複数の記事をお気に入りとして登録できる | ・ログインしているユーザだけお気に入りへの登録ができる<br>・ユーザページでお気に入りに登録した記事が表示される<br>・記事の詳細でお気に入りに登録しているユーザの数が表示される |

## 実装予定の機能

・記事削除機能<br>
・お気に入り登録機能

## データベース設計

### usersテーブル

| Column             | Type   | Options                   |
| ------------------ | ------ | ------------------------- |
| name               | string | null: false, unique: true |
| email              | string | null: false, unique: true |
| encrypted_password | string | null: false               |
| introduction       | text   |                           |

#### Association

has_many :diaries  
has_many :comments  

### diariesテーブル

| Column  | Type       | Options                        |
| ------- | ---------- | ------------------------------ |
| title   | string     | null: false                    |
| content | text       |                                |
| user    | references | null: false, foreign_key: true |

#### Association

belongs_to :user  
has_many :comments  
has_many :tags, through: :diary_tags  
has_many :diary_tags  

### commentsテーブル

| Column   | Type       | Options                        |
| -------- | ---------- | ------------------------------ |
| comment  | string     | null: false                    |
| user     | references | null: false, foreign_key: true |
| diary    | references | null: false, foreign_key: true |

#### Association

belongs_to :user  
belongs_to :diary  

### diary_tagsテーブル

| Column | Type       | Options                        |
| ------ | ---------- | ------------------------------ |
| diary  | references | null: false, foreign_key: true |
| tag    | references | null: false, foreign_key: true |

#### Association

belongs_to :diary  
belongs_to :tag  

### tagsテーブル

| Column | Type   | Options     |
| ------ | ------ | ----------- |
| tag_name   | string | null: false |

#### Association

has_many :diaries, through: :diary_tags  
has_many :diary_tags  

## ローカルでの動作方法